Laws
============
2017-01-31 --> work in progress


Laws: layout and widget system.

Laws is a system for displaying an html page in a way that allows theming (separation between the data
and how they are displayed).



Overview of the layout tree
=============================


<!-zuk-laws.png->



Laws defines three main objects:

- layout
- widget group
- widget


Widgets are used to display the page elements (for instance a menu, a slider, a login bar, a blog post, ...).

Widgets can be grouped in widget groups.
 
Widgets and widget groups are positioned in the layout.


All those objects connect together and form the **layout tree**.

In a zuk web application, the Controller is responsible for displaying an html page.

The Controller can use a Layout tree in order to do that.



Nomenclature
===============
Each node of the tree has a unique name, and so we can target any node of the tree, if necessary.

Let's learn some useful vocabulary.

Imagine that we are inside a Controller named MyController, which uses a layout named MyLayout, 
which contains a widget group named MyWidgetGroup, which itself contains a widget named MyWidget.

Then the following vocabulary is available:

- **MyController**: name of the Controller
- **MyWidgetGroup/MyWidget**: relative path (starting from the layout object) to the widget node, or widget group node
- **MyController/MyLayout/MyWidgetGroup/MyWidget**: absolute path of the widget node






The associated theme files
====================

In order to display themselves, the three main objects (layout, widgets and widget groups) use a file.

- Layouts use a **layout file**, which displays the html page; it contains calls to widgets and widget groups
- Widget groups use a **widget group file**, which displays the content of a widget group; it contains calls to widgets and widget groups
- Widgets use a **widget file** (aka **template**), which displays the content of a widget; it contains calls to variables

Those files are represented on the right of the figure at the top of this document.




Override system
===================



Summary
-----------

Here are the locations where a theme file is looked into (ordered by descendant precedence).

Note: the default themeName is **default** and the default controllerName is **_nocontroller**.

Note: {relativePath} is defined in the "nomenclature" section of this document.




- Layout file 
    - app/themes/{themeName}/laws/{controllerName}/layouts/{layoutName}.tpl 
    - app/class-modules/{moduleName}/themes/{themeName}/laws/{controllerName}/layouts/{layoutName}.tpl
    - app/themes/{themeName}/laws/_nocontroller/layouts/{layoutName}.tpl
    - app/class-modules/{moduleName}/themes/{themeName}/laws/_nocontroller/layouts/{layoutName}.tpl 
- Widget groups file 
    - app/themes/{themeName}/laws/{controllerName}/widgetgroups/{layoutName}/{relativePath}.tpl 
    - app/class-modules/{moduleName}/themes/{themeName}/laws/{controllerName}/widgetgroups/{layoutName}/{relativePath}.tpl
    - app/themes/{themeName}/laws/_nocontroller/widgetgroups/{layoutName}/{relativePath}.tpl
    - app/class-modules/{moduleName}/themes/{themeName}/laws/_nocontroller/widgetgroups/{layoutName}/{relativePath}.tpl
- Widgets
    - app/themes/{themeName}/laws/{controllerName}/widgets/{layoutName}/{relativePath}.tpl
    - app/class-modules/{moduleName}/themes/{themeName}/laws/{controllerName}/widgets/{layoutName}/{relativePath}.tpl
    - app/themes/{themeName}/laws/_nocontroller/widgets/{layoutName}/{relativePath}.tpl
    - app/class-modules/{moduleName}/themes/{themeName}/laws/_nocontroller/widgets/{layoutName}/{relativePath}.tpl 
 





Long Explanations
-------------------

The whole point of using laws is to be able to change theme rapidly.

As almost everything in a zuk application, it starts with a module.

So for instance a module author creates a blog module, which contains all the necessary Controllers.
 
Each Controller use their own layouts.


When we install such a module, the theme files are still at the module level.

Here is what it should look like:


```txt
- app/
----- class-modules/
--------- MyModule/
------------- themes/   
----------------- default/                      # default is a special identifier that identifies the default theme that each module should have
--------------------- laws/                     # contains all laws related theme files
------------------------- _nocontroller/        # contains all theme files not specific to any Controller
----------------------------- layouts/          # all layout files goes in this directory 
--------------------------------- MyModuleFirstLayout.tpl 
--------------------------------- ...
----------------------------- widgetgroups/     # all widget group files goes in this directory
--------------------------------- MyModuleFirstLayout/ 
------------------------------------- widgetGroupName.tpl
------------------------------------- widgetGroupName2/
----------------------------------------- nestedWidgetGroupName.tpl
------------------------------------- widgetGroupName3.tpl
--------------------------------- ... 
----------------------------- widgets/          # all widget files goes in this directory
--------------------------------- MyModuleFirstLayout/ 
------------------------------------- widgetGroupName/
----------------------------------------- widgetOne.tpl
----------------------------------------- ...
--------------------------------- ... 
--------- MyModule2/
--------- ...
```

Now to create a new theme, create the **themes/mytheme/MyModule** directory (for instance),
and copy the **app/class-modules/MyModule/themes/default/laws** directory inside of it.

Your structure should look like this:


```txt
- app/
----- class-modules/
----- themes/
--------- mytheme/
------------- MyModule/
--------------------- laws/                     # contains all laws related theme files
------------------------- _nocontroller/        # contains all theme files not specific to any Controller
----------------------------- layouts/          # all layout files goes in this directory 
--------------------------------- MyModuleFirstLayout.tpl 
--------------------------------- ...
----------------------------- widgetgroups/     # all widget group files goes in this directory
--------------------------------- MyModuleFirstLayout/ 
------------------------------------- widgetGroupName.tpl
------------------------------------- widgetGroupName2/
----------------------------------------- nestedWidgetGroupName.tpl
------------------------------------- widgetGroupName3.tpl
--------------------------------- ... 
----------------------------- widgets/          # all widget files goes in this directory
--------------------------------- MyModuleFirstLayout/ 
------------------------------------- widgetGroupName/
----------------------------------------- widgetOne.tpl
----------------------------------------- ...
--------------------------------- ... 

```


That's it, we have successfully overridden the MyModule theme.




New
==========

layout name convention: MyLayout (ends with Layout, also do Controller suffix for Controllers)
goal: shorten the overriding path


widgets don't change template (much?). 
goal: shorten the overriding path


IF the code comes from a module ONLY, then all this applies.
If not, then you can name things how you want.






